Note! You will need tensorflow-gpu version 2.8.0 or higher. Your version is 2.8.0
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Found 58085 files belonging to 1 classes.
Using 40660 files for training.
Found 58085 files belonging to 1 classes.
Using 17425 files for validation.
Wall time: 4.9 s
(8, 360, 240, 3)
WARNING:tensorflow:AutoGraph could not transform <function <lambda> at 0x0000021F5A37ED30> and will run it as-is.
Cause: could not parse the source code of <function <lambda> at 0x0000021F5A37ED30>: no matching AST found among candidates:
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform <function <lambda> at 0x0000021F5A37ED30> and will run it as-is.
Cause: could not parse the source code of <function <lambda> at 0x0000021F5A37ED30>: no matching AST found among candidates:
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
<MapDataset element_spec=TensorSpec(shape=(None, 360, 240, 3), dtype=tf.float32, name=None)>
(4, 360, 240, 3)
In range between:  0.0  and:  1.0
Wall time: 22min 44s
Generating DCGAN model.
DCGAN model completed
(1, 360, 240, 3)
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 dense (Dense)               (None, 345600)            34560000
 reshape (Reshape)           (None, 45, 30, 256)       0
 conv2d_transpose (Conv2DTra  (None, 45, 30, 128)      819200
 nspose)
 leaky_re_lu (LeakyReLU)     (None, 45, 30, 128)       0
 conv2d_transpose_1 (Conv2DT  (None, 90, 60, 64)       204800
 ranspose)
 leaky_re_lu_1 (LeakyReLU)   (None, 90, 60, 64)        0
 conv2d_transpose_2 (Conv2DT  (None, 180, 120, 32)     51200
 ranspose)
 leaky_re_lu_2 (LeakyReLU)   (None, 180, 120, 32)      0
 conv2d_transpose_3 (Conv2DT  (None, 360, 240, 3)      2400
 ranspose)
=================================================================
Total params: 35,637,600
Trainable params: 35,637,600
Non-trainable params: 0
_________________________________________________________________
Wall time: 14.2 s
DCGAN descriminator model
(None, 1)
DCGAN descriminator Completed!!
tf.Tensor([[0.49997866]], shape=(1, 1), dtype=float32)
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 conv2d (Conv2D)             (None, 180, 120, 32)      2432
 leaky_re_lu_3 (LeakyReLU)   (None, 180, 120, 32)      0
 conv2d_1 (Conv2D)           (None, 90, 60, 64)        51264
 leaky_re_lu_4 (LeakyReLU)   (None, 90, 60, 64)        0
 conv2d_2 (Conv2D)           (None, 45, 30, 128)       204928
 leaky_re_lu_5 (LeakyReLU)   (None, 45, 30, 128)       0
 conv2d_3 (Conv2D)           (None, 23, 15, 256)       819456
 leaky_re_lu_6 (LeakyReLU)   (None, 23, 15, 256)       0
 flatten (Flatten)           (None, 88320)             0
 dropout (Dropout)           (None, 88320)             0
 dense_1 (Dense)             (None, 1)                 88321
=================================================================
Total params: 1,166,401
Trainable params: 1,166,401
Non-trainable params: 0
_________________________________________________________________
Training Start...
Epoch : 0
Training step
Generator for noise
Discriminator for images
Discriminator for noise
C:\Users\alexd\.conda\envs\tf-gpu\lib\site-packages\tensorflow\python\util\dispatch.py:1082: UserWarning: "`binary_crossentropy` received `from_logits=True`, but the `output` argument was produced by a sigmoid or softmax activation and thus does not represent logits. Was this intended?"
  return dispatch_target(*args, **kwargs)
gen_loss : Tensor("binary_crossentropy/weighted_loss/value:0", shape=(), dtype=float32)
disc_loss : Tensor("add:0", shape=(), dtype=float32)
Training step
Generator for noise
Discriminator for images
Discriminator for noise
gen_loss : Tensor("binary_crossentropy/weighted_loss/value:0", shape=(), dtype=float32)
disc_loss : Tensor("add:0", shape=(), dtype=float32)
Training step
Generator for noise
Discriminator for images
Discriminator for noise
gen_loss : Tensor("binary_crossentropy/weighted_loss/value:0", shape=(), dtype=float32)
disc_loss : Tensor("add:0", shape=(), dtype=float32)
9
Time for epoch 1 is 2687.8446712493896 sec
Epoch : 1
9
Time for epoch 2 is 2068.073127746582 sec
Epoch : 2
9
Time for epoch 3 is 2140.856386899948 sec
Epoch : 3
9
Time for epoch 4 is 2145.3756256103516 sec
Epoch : 4
9
Time for epoch 5 is 2223.2320709228516 sec
